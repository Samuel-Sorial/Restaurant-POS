<%- include('../includes/navbar.ejs') %>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
</head>
<body>
    <div class="d-flex flex-column" id="content-wrapper">
        <div class="container">
            <form method="POST" action="/admin/manage-category-<%= category.categoryId %>">
                <h3 style="padding-top: 25px;">Edit category name:</h1>
                <div class="form-group"><input name="categoryName" class="form-control" type="text" value="<%= category.name %>"></div>
                <button class="btn btn-primary btn-block text-white btn-user" type="submit">Save category</button>
            </form>
            <form id="<%= category.categoryId %>" style="margin-top: 25px;" action="/admin/manage-category" method="GET">
                <button id="delete" class="btn btn-primary btn-block text-white btn-user" type="submit">Delete Category</button>
            </form>             
        </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
    <script src="/js/bs-init.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.js"></script>
    <script src="/js/theme.js"></script>
        <script>
            document.getElementById('delete').addEventListener("click", (event) => {
                let sure = confirm('Are you sure you want to delete this category? Note: if you delete, all products inside it will be deleted');
                if(sure){
                    const id = event.target.parentElement.id;
                    fetch( `http://` + window.location.host + `/admin/manage-category-${id}`, {
                        method: 'DELETE'})
                    .then()
                    .catch(err=> console.log(err));
                    }
            });
        </script>
</body>


<%- include('../includes/end.ejs') %>